# Human_Model_Render

<p align="center">
	<img src="https://github.com/li19960612/Human_Model_Render/blob/master/demo/pipeline.png" alt="Sample"  width="700">
</p>

## Description
The reposity contains the code that generates the human models from rgb images or videos, binds the human texture onto the model, and renders it to screen. The texture can be arbitrary. The code use the high-definition version of input images as the texture, it looks like reference-based human super resolution.

For the motion, the project use [SMPL](https://smpl.is.tue.mpg.de/) as basic model, the [OpenPose](https://github.com/CMU-Perceptual-Computing-Lab/openpose), [PSPNet](https://github.com/Lextal/pspnet-pytorch) and the [HMR](https://github.com/akanazawa/hmr) as the constraint of re-projection. Combined with reasonable temporal contraint, it can produce a reasonable result. 

For the mesh reconstruction, the project expand the contour of SMPL to fit the human silhouette in image to generate new template. The [Multi-label $\alpha$-expansion](https://vision.cs.uwaterloo.ca/code/) is used to find the correspondence between the contours of SMPL and image. To reduce the peak noise in edge, the laplacian coordination is used to preserve the smoothness of edge.

The project use [opendr](https://pypi.org/project/opendr/) as a simple rendering tool. But it may produce a low-quality texture. Alternatively, the [OpenGL](https://www.opengl.org/) is used to generate the final texture. 

## Data Preprocessing
The high and low definition images can be captured with common multi-camera surveillance, such as Hikvision. The best way is to crop the human using detection. [YOLO](https://github.com/AlexeyAB/darknet) and [KCF](https://github.com/joaofaro/KCFcpp) are recommended to generate the feasible data. 

## Installation
```
conda create -n conda_name python=2.7
pip install -r requirements.txt
pip install pip==8.1.1
pip install opendr==0.78
pip install --upgrade pip
```

## Demo
There are some rendering result in MPII dataset. The input configuration is **a high-definition human image**, **a low-definition human images sequence which is $\times$ 8 downsampled**. The human model sequence with high-definition texture generated by the algorithm is rendered to obtain the detailed human images sequence.  

### model reconstruction results
<p align="center">
	<img src="https://personal-1301265575.cos.ap-shenzhen-fsi.myqcloud.com/Human_Render/media6.gif" alt="Sample" width="500">
</p>

### final results
<p align="center">
	<img src="https://personal-1301265575.cos.ap-shenzhen-fsi.myqcloud.com/Human_Render/media6.gif" alt="Sample"  width="500">
	<img src="https://personal-1301265575.cos.ap-shenzhen-fsi.myqcloud.com/Human_Render/media6.gif" alt="Sample"  width="500">

</p>

And There are also some visual results captured with our hybrid camera system similar to Hikvision surveillance.

### model reconstruction results

### final results


